



Network Working Group                                            C. Wood
Internet-Draft                                                Apple Inc.
Intended status: Informational                         February 18, 2018
Expires: August 22, 2018


                        EDNS(0) Privacy Options
                 draft-wood-dprive-edns0-privacy-latest

Abstract

   TODO

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on August 22, 2018.

Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.







Wood                     Expires August 22, 2018                [Page 1]

Internet-Draft           EDNS(0) Privacy Options           February 2018


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  Privacy Attacks . . . . . . . . . . . . . . . . . . . . . . .   3
   4.  "Private" Option  . . . . . . . . . . . . . . . . . . . . . .   3
   5.  Requestor Usage and Behavior  . . . . . . . . . . . . . . . .   3
   6.  Responder Usage and Behavior  . . . . . . . . . . . . . . . .   4
     6.1.  Delay Distributions . . . . . . . . . . . . . . . . . . .   4
   7.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   4
   8.  Security Considerations . . . . . . . . . . . . . . . . . . .   4
   9.  Privacy Considerations  . . . . . . . . . . . . . . . . . . .   5
   10. Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .   5
   11. Normative References  . . . . . . . . . . . . . . . . . . . .   5
   Appendix A.  Timing Oracle Attack Code  . . . . . . . . . . . . .   6
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .   6

1.  Introduction

   The Domain Name System (DNS) [RFC1035] was designed to transport all
   messages in cleartext.  By default, this provides no privacy,
   confidentiality, or integrity (in the absence of DNSSEC [RFC4033])
   for all client queries and responses.  [RFC7858] standardizes running
   DNS over (D)TLS to protect data in transit.  This prevents passive
   eavesdroppers from seeing cleartext data, though it does not mitigate
   traffic analysis of data based on packet sizing, for example, which
   can be an adequate side channel for learning underlying queries and
   responses ((CITE:SHULMAN)).  [RFC7830] and
   [I-D.ietf-dprive-padding-policy] offer mechanisms and advice for
   clients and servers to pad padding to queries and responses to mask
   real message size information.  Padding profiles in
   [I-D.ietf-dprive-padding-policy] are informed by analyis of DNS
   message datasets ((TODO:CITE)), though more analysis could and should
   be done to better understand this mechanism.

   One privacy-sensitive side channel introduced by DNS recursive
   resolvers and not covered by existing mechanisms is caused by
   caching.  Specifically, recursive resolvers that cache responses and
   use them in response to queries make the observed latency to clients
   less than that for non-cached or stale records.  Malicious clients
   may exploit this side channel as an oracle to learn what records were
   previously requested by nearby clients.  Source code for an attack
   exploiting this side channel is given in Appendix A.

   In this document, we propose a new EDNS(0) option that allows clients
   to mark queries as privacy sensitive.  We specify recursive behavior
   when processing private queries and caching their responses.  Usage
   of this option SHOULD only be enabled when running over a secure



Wood                     Expires August 22, 2018                [Page 2]

Internet-Draft           EDNS(0) Privacy Options           February 2018


   transport such as TLS [RFC7858], as otherwise recursive resolvers or
   other responders are subject to denial-of-service attacks.

2.  Terminology

   The terms "Requestor" and "Responder" are to be interpreted as
   specified in [RFC6891].

3.  Privacy Attacks

   TODO: attack description(s)

4.  "Private" Option

   EDNS(0) [RFC6891] specifies a mechanism to include new options in DNS
   messages.  This document specifies a new "Private" option that allows
   clients to indicate

   0                       8                      16
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
   |                  OPTION-CODE                  |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
   |                 OPTION-LENGTH                 |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
   |     PRIVATE Option    |
   +--+--+--+--+--+--+--+--+

   The OPTION-CODE for the "Private" option is TBD.

   The OPTION-LENGTH for the "Private" option is one octet.

   The PRIVATE octet MUST be set to 0x01.  Presence of this option
   indicates that a query is private.  Other values MUST NOT be used.
   Responders, such as recursive resolvers, MUST drop the query if
   another value is set, as discussed in Section Section 6.

5.  Requestor Usage and Behavior

   Requestors MAY include a "Private" option for any query deemed
   private or sensitive.  This may include queries for explicitly known-
   to-be private domains or for all domains when operating in a
   "private" mode.  Specific recommendations for when to include this
   option are outside the scope of this document.








Wood                     Expires August 22, 2018                [Page 3]

Internet-Draft           EDNS(0) Privacy Options           February 2018


6.  Responder Usage and Behavior

   Responders that receive a query Q with "Private" options MUST do one
   of the following to satisfy Q:

   1.  If response R is not cached, resolve Q using upstream
       authoritative or recursive resolvers.

   2.  If response R is cached, ignore R and attempt to resolve Q using
       upstream authoritative or recursive resolvers.

   3.  If response R is cached, delay sending R to the requestor until
       some time T has passed.  T is a random variable with distribution
       equal to the resolution distribution time of R.

   TODO: summarize rules for privacy bits in queries and different
   attacks

6.1.  Delay Distributions

   T measurement and distribution estimation is critical for masking the
   timing side channel described in Section Section 1.  Both should be
   chosen to maximize requestor utility while minimizing responder
   overhead.  We draw on observations and experiments by [Acs17] in
   deciding these factors.

   Responders SHOULD measure query resolution time T' and use this in
   selecting T's distribution.  There are two recommended delay
   strategies for responders assuming knowledge of T', including:

   1.  Uniform: Delay for some time T* that is selected uniformly at
       random in the range [0, T'], i.e,. with probability distribution
       function Pr[T = t] = 1/T'.

   2.  Geometric: Delay for some time T* that is selected according to a
       geometric distribution, i.e., with probability distribution
       function Pr[T = t] = (1 - t) * t^k, where k is a parameter for
       the distribution.

7.  IANA Considerations

   ((TODO: codepoint for option type))

8.  Security Considerations

   TODO





Wood                     Expires August 22, 2018                [Page 4]

Internet-Draft           EDNS(0) Privacy Options           February 2018


9.  Privacy Considerations

   TODO

10.  Acknowledgments

   TODO

11.  Normative References

   [Acs17]    "Privacy-Aware Caching in Information-Centric Networking",
              n.d., <http://ieeexplore.ieee.org/document/7874168/>.

   [I-D.ietf-dprive-padding-policy]
              Mayrhofer, A., "Padding Policy for EDNS(0)", draft-ietf-
              dprive-padding-policy-04 (work in progress), February
              2018.

   [I-D.ietf-tls-tls13]
              Rescorla, E., "The Transport Layer Security (TLS) Protocol
              Version 1.3", draft-ietf-tls-tls13-24 (work in progress),
              February 2018.

   [RFC1035]  Mockapetris, P., "Domain names - implementation and
              specification", STD 13, RFC 1035, DOI 10.17487/RFC1035,
              November 1987, <https://www.rfc-editor.org/info/rfc1035>.

   [RFC2104]  Krawczyk, H., Bellare, M., and R. Canetti, "HMAC: Keyed-
              Hashing for Message Authentication", RFC 2104,
              DOI 10.17487/RFC2104, February 1997, <https://www.rfc-
              editor.org/info/rfc2104>.

   [RFC4033]  Arends, R., Austein, R., Larson, M., Massey, D., and S.
              Rose, "DNS Security Introduction and Requirements",
              RFC 4033, DOI 10.17487/RFC4033, March 2005,
              <https://www.rfc-editor.org/info/rfc4033>.

   [RFC5077]  Salowey, J., Zhou, H., Eronen, P., and H. Tschofenig,
              "Transport Layer Security (TLS) Session Resumption without
              Server-Side State", RFC 5077, DOI 10.17487/RFC5077,
              January 2008, <https://www.rfc-editor.org/info/rfc5077>.

   [RFC6891]  Damas, J., Graff, M., and P. Vixie, "Extension Mechanisms
              for DNS (EDNS(0))", STD 75, RFC 6891,
              DOI 10.17487/RFC6891, April 2013, <https://www.rfc-
              editor.org/info/rfc6891>.





Wood                     Expires August 22, 2018                [Page 5]

Internet-Draft           EDNS(0) Privacy Options           February 2018


   [RFC7830]  Mayrhofer, A., "The EDNS(0) Padding Option", RFC 7830,
              DOI 10.17487/RFC7830, May 2016, <https://www.rfc-
              editor.org/info/rfc7830>.

   [RFC7858]  Hu, Z., Zhu, L., Heidemann, J., Mankin, A., Wessels, D.,
              and P. Hoffman, "Specification for DNS over Transport
              Layer Security (TLS)", RFC 7858, DOI 10.17487/RFC7858, May
              2016, <https://www.rfc-editor.org/info/rfc7858>.

Appendix A.  Timing Oracle Attack Code

   TODO: include bash script that connects to recursive and performs
   correlation attack

Author's Address

   Christopher A. Wood
   Apple Inc.
   1 Infinite Loop
   Cupertino, California 95014
   United States of America

   Email: cawood@apple.com




























Wood                     Expires August 22, 2018                [Page 6]
